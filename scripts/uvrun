#!/usr/bin/env bash
set -euo pipefail

SCRIPT_DIR="$(cd -- "$(dirname -- "${BASH_SOURCE[0]}")" && pwd)"
REPO_ROOT="$(cd -- "${SCRIPT_DIR}/.." && pwd)"
UV_BIN="${REPO_ROOT}/.venv/bin/uv"

if [[ ! -x "${UV_BIN}" ]]; then
  echo "Missing executable: ${UV_BIN}" >&2
  echo "Install uv into the virtual environment first (for example: .venv/bin/python -m pip install uv)." >&2
  exit 1
fi

cd "${REPO_ROOT}"
export UV_CACHE_DIR="${UV_CACHE_DIR:-${REPO_ROOT}/.uv-cache}"

exec "${UV_BIN}" run --no-sync "$@"
